# Git hooks with husky

Этот топик является предварительным условиям для некоторых инструментов из раздела **Окружение**. Здесь вкратце рассказывается о том, что такое `git hooks`, `husky` и как установить `husky` в ваш проект.

## Что такое `git hooks`?

Хуки Git - это встроенный функционал Git, который позволяет вызывать пользовательские скрипты в случае возникновения определённых Git-событий. Например хук `pre-commit` будет вызван после вызова команды `git commit`, но перед фактическим созданием коммита. В этом хуке можно запустить тесты, линтеры или выполнить любую другую проверку кода. Если выполнение хука завершится с кодом, отличным от нуля, создание коммита будет отменено. Или хук `commit-msg` позволяет проверить сообщение коммита на соответствие заданному шаблону. Подробнее о хуках Git можно почитать в [официальной документации](https://git-scm.com/book/ru/v2/%D0%9D%D0%B0%D1%81%D1%82%D1%80%D0%BE%D0%B9%D0%BA%D0%B0-Git-%D0%A5%D1%83%D0%BA%D0%B8-%D0%B2-Git).

## Что такое `husky`?

[Husky](https://typicode.github.io/husky/) — это инструмент, который позволяет нам легко использовать хуки Git и запускать нужные нам сценарии на разных событиях. Для этого достаточно добавить скрипт в файл `.husky/[название-хука]` вашего проекта.

### Установка

1. Используя ваш пакетный менеджер установите husky в качестве devDependency, 
например: 
    
    `npm install husky --save-dev`

2. Добавьте в ваш `package.json` следующую строчку:

    ```json
    {
      "scripts": {
        "prepare": "husky install" 
      }
    }
    ```
    Если вы используете Yarn 2+, замените `prepare` на `postinstall`

3. Выполните команду установки зависимостей. 

    Скрипт `prepare` является [скриптом жизненного цикла](https://docs.npmjs.com/cli/v10/using-npm/scripts#life-cycle-scripts), который будет выполняться после каждой установки зависимостей. Команда `husky install` в свою очередь активирует хуки Git от `husky`.

4. Если вы используете Yarn 2+, ваш репозиторий публичный и вы публикуете его в реестре (напр. **npmjs.com**), вам необходимо установить `yarn add pinst --dev` и добавить в `package.json` следующее:

    ```json
    {
      "scripts": {
        "postinstall": "husky install",
        "prepack": "pinst --disable",
        "postpack": "pinst --enable"
      }
    }
    ```
    Подробнее в [документации](https://typicode.github.io/husky/getting-started.html#yarn-2).

После установки в корне вашего проекта появится папка `.husky`, внутри которой вы можете добавлять свои скрипты для разных [Git событий](https://git-scm.com/book/ru/v2/%D0%9D%D0%B0%D1%81%D1%82%D1%80%D0%BE%D0%B9%D0%BA%D0%B0-Git-%D0%A5%D1%83%D0%BA%D0%B8-%D0%B2-Git). Эта папка будет использоваться для некоторых инструментов из раздела **Окружение**.